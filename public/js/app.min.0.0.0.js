(function(){var e;e=function(){function e(){var e;return angular.element(document).ready(function(e){return function(){return e.load()}}(this)),THREE.warn=function(){},console.warn=function(){},e="phase-"+env.PHASE,"1"!==env.PHASE&&(e+=" phase-live"),$("body").addClass(e),["ngAria","ngRoute","angularXml2json","ngUpload","facebook","ngLodash","ngAnimate","ngSanitize","twitterFilters"]}return e.prototype.load=function(){var e;return e=angular.module("app"),AssetLoader.load(Assets.all()).then(function(e){return function(t){return Assets.update(t),e.start()}}(this),function(e){return console.log(e)})},e.prototype.start=function(){return c.enable=!0,angular.bootstrap(document,["app"])},e}(),angular.module("app",new e)}).call(this),function(){var e;e=function(){function e(e){var t;return t=1,{addClass:function(e,n,o){var r;return"ng-hide"===n?(TweenMax.killTweensOf(e),TweenMax.set(e,{opacity:1}),r={opacity:0,onComplete:o,ease:Power2.easeOut},TweenMax.to(e,t,r)):o()},removeClass:function(e,n,o){var r;return"ng-hide"===n?(TweenMax.killTweensOf(e),TweenMax.set(e,{opacity:0,position:"absolute"}),r={opacity:1,delay:2,onStart:function(t){return function(){return e.attr("style","")}}(this),onComplete:o,ease:Power2.easeOut},TweenMax.to(e,t,r)):o()}}}return e}(),angular.module("app").animation(".explore-fade-to",["$rootScope",e])}.call(this),function(){var e;e=function(){function e(e){var t;return t=1,{addClass:function(e,n,o){var r;return"ng-hide"===n?(TweenMax.killTweensOf(e),TweenMax.set(e,{opacity:1}),r={opacity:0,onComplete:o,ease:Power2.easeOut},TweenMax.to(e,t,r)):o()},removeClass:function(e,n,o){var r;return"ng-hide"===n?(TweenMax.killTweensOf(e),TweenMax.set(e,{opacity:0,position:"absolute"}),r={opacity:1,delay:1.1,onStart:function(t){return function(){return e.attr("style","")}}(this),onComplete:o,ease:Power2.easeOut},TweenMax.to(e,t,r)):o()}}}return e}(),angular.module("app").animation(".fade-to",["$rootScope",e])}.call(this),function(){var e;e=function(){function e(e){e.init(env.FACEBOOK_APP_ID)}return e}(),angular.module("app").config(["FacebookProvider",e])}.call(this),function(){var e;e=function(){function e(e,t,n,o,r,i,a,s){e.show=!1,e.monumentReady=!1,e.showWebgl=!1,e.showFallback=!1,e.userHasRegistered=!1,e.showMonumentBackground="1"===env.PHASE?!1:!0,e.user=null,e.userLoggedIn=!1,e.userNotDragging=!0,e.showIntro=!1,e.showUserPopup=!1,e.playObjectTransition=!1,e.showUserTooltip=!1,e.showClaimTooltip=!1,e.deeplinkedToSpot=!1,e.registrationOpen=!1,e.showShare=!1,e.tooltipDirection="",e.currentTooltipType="claim",e.tooltip={x:0,y:0},e.isHovering="",e.foundUser={firstname:"alexandre",lastname:"francois",city:"Von London",profilePicture:""},t.$on("monument.ready",function(){return e.$apply(function(t){return function(){return e.monumentReady=!0,env.WEBGL?e.showWebgl=!0:e.showFallback=!0}}(this))})}return e}(),angular.module("app").controller("exploreController",["$scope","$rootScope","$location","Utils","Dictionary","Settings","Timeline","Win",e])}.call(this),function(){var e;e=function(){function e(e){return{require:"ngModel",restrict:"A",link:function(t,n,o,r){return r.$parsers.push(function(t){return r.$setValidity("emailAvailable",!0),r.$valid&&(r.$setValidity("checkingEmail",!1),""!==t&&"undefined"!=typeof t?e.get("/api/user-email-available/"+t).success(function(e,t,n,o){return r.$setValidity("emailAvailable",!0),r.$setValidity("checkingEmail",!0)}).error(function(e,t,n,o){return r.$setValidity("emailAvailable",!1),r.$setValidity("checkingEmail",!0)}):(r.$setValidity("emailAvailable",!1),r.$setValidity("checkingEmail",!0))),t})}}}return e}(),angular.module("app").directive("emailAvailable",["$http",e])}.call(this),function(){var e;e=function(){function e(){return{restrict:"A",link:function(e,t,n){var o;return o=e.$eval(n.fileOnChange),t.bind("change",o)}}}return e}(),angular.module("app").directive("fileOnChange",[e])}.call(this),function(){var e;e=function(){function e(e,t,n,o,r){return{restrict:"A",link:function(e,t,i){var a,s;return a=$(t),a.find("[modal-link-join]").on("click",function(){return o.url("/"+env.LOCALE+"/join")}),s=function(e){return function(){var e,n,o;return t.css("display","block"),e=t.find(".modal-dialog"),o=($(window).height()-e.height())/2,n=parseInt(e.css("marginBottom"),10),n>o&&(o=n),e.css("margin-top",o)}}(this),t.on("show.bs.modal",function(e){return function(e){return n.$emit("show.bs.modal"),c.log($(e.currentTarget).attr("id")),"aboutModal"===$(e.currentTarget).attr("id")&&(c.debug("ga('send','pageview','de-de/monument-der-freundschaft/about')"),ga("send","pageview","de-de/monument-der-freundschaft/about")),s()}}(this)),t.on("hide.bs.modal",function(e){return function(e){return n.$emit("hide.bs.modal")}}(this)),e.trackPDFDownload=function(e){var t;return t=r.get("downloadPDFUrl"),c.debug("ga('send', 'event', 'monument-der-freundschaft:join', 'download','"+t+"')"),ga("send","event","monument-der-freundschaft:join","download",t)},$}}}return e}(),angular.module("app").directive("modal",["$window","$parse","$rootScope","$location","Dictionary",e])}.call(this),function(){var e;e=function(){function e(e,t,n,o,r,i,a,s,u,l,c,d,p,f,h,m,g){return{restrict:"A",scope:{enabled:"=enabled",userloggedin:"=userloggedin"},link:function(e,n){var o,a,h,m,v,y,w,T,E,b,x,M,P,H,A,R,k,S,I;return this.$scope=e,this.$element=n,env.WEBGL?void 0:(S=!1,b=!1,v=null,o=$(".phase-2-background"),y=new DragIOFallback(this.$element,f.device,p),y.on("drag.start",function(e){return function(){return e.$scope.$emit("monument.hideTooltip")}}(this)),x=[],m=function(){var e,t,n,o,r,a,s,u,c,d,p,f,h;for(e=Assets.getAsset("Bottle").url,t=Assets.getAsset("Particle").url,p=i.getOrder(),p=p.splice(0,256),f=0,n=0,h=[],o=a=0,s=p.length;s>a;o=++a){switch(c=p[o]){case"particle":d=f,r=t,f++;break;case"bottle":d=n,r=e,n++}u=new l({index:o,occurance:d,objectType:c,parent:this.$element.find(".objects-container"),image:r}),u.on("click",M),u.on("over",H),u.on("out",P),h.push(x.push(u))}return h},a=function(e,t){var n,o,i;switch(null==t&&(t=!0),E(),o=.4*p.width,i=.52*p.height,n=r.find(x,{index:e.index}),null!=n&&n.fadeOut(),c.setPosition(t),d.setPosition(t),e.objectType){case"bottle":c.fadeIn();break;case"particle":d.fadeIn()}return y.disable()},h=function(){var e;if(null!=v)return e=r.find(x,{index:v.index}),null!=e&&e.fadeIn(),d.fadeOut(),c.fadeOut()},E=function(){return TweenLite.to(this.$element,1,{opacity:.35})},T=function(){return TweenLite.to(this.$element,1,{opacity:1})},A=function(){var e,t,n;if(null==v)switch(e=s.getRandomDataForRegistration().assetType){case"particle":t=_.findByValues(x,"objectType",["particle"]),n=g.randomArrayItem(t).item,v={index:n.index,objectType:e,objectIndex:n.occurance,animateFromPosition:!1};break;case"bottle":t=_.findByValues(x,"objectType",["bottle"]),n=g.randomArrayItem(t).item,v={index:n.index,objectType:e,objectIndex:n.occurance,animateFromPosition:!1}}return a(v)},R=function(){return h()},k=function(){return a(v)},I=function(e){return c.updatePhotoTexture(e),d.updatePhotoTexture(e)},this.animateIn=function(e,n){return null==e&&(e=5),null==n&&(n=!1),t.$emit("on.transition.in"),S=!0},this.animateInToUserObject=function(e){var n,o,i,a,s;return null==e&&(e=!0),t.$emit("on.transition.in"),S=!1,s=u.get(),o=parseInt(s.occurance),n=r.find(x,{occurance:o}),null==n&&(n=g.randomArrayItem(x).item),a=this.$element,TweenLite.killTweensOf(a),i={ease:Power2.easeInOut,onComplete:function(t){return function(){return S=!0,w(e)}}(this)},i.scrollTop=n.getScrollTop(),TweenLite.to(a,1.5,i)},M=function(e){return y.enabled!==!1?(v=e,console.log("currentObjectData ---->",v)):void 0},H=function(e){return function(t){return y.enabled!==!1?y.isDragging?void 0:(v=t,b=!0,e.$scope.$emit("monument.showTooltip",t)):void 0}}(this),P=function(e){return b=!1},w=function(e){var t,n;return n=u.get(),n?(t=r.find(x,{occurance:parseInt(n.occurance),objectType:n.assetType}),null==t&&(t=g.randomArrayItem(x).item),v={object:t,objectType:t.objectType,index:t.index,animateFromPosition:!0},I(u.get().profilePicture),a(v,e)):void 0},t.$on("register.upload.photo",function(e){return function(e,t){return I(t.image)}}(this)),t.$on("register.back.clicked",function(e){return function(){return h(),T()}}(this)),t.$on("register.complete",function(e){return function(){return R()}}(this)),t.$on("mobile.register.prev.state",function(e){return function(){return k()}}(this)),t.$on("mobile.register.next.state",function(e){return function(){return R()}}(this)),E(),t.$on("$locationChangeStart",function(e){return function(t){var n;return n=g.getPath().split("/")[1],angular.equals(n,"join")&&E(),angular.equals(n,"")&&(h(),E()),angular.equals(n,"register")&&(E(),e.$scope.userloggedin===!1&&(c.resetTexture(),d.resetTexture(),A())),_.isNumber(g.getDeeplinkUserIndex())&&null!=u.get()?(E(),e.animateInToUserObject(!1)):angular.equals(g.getUriSegment(1),"explore")?(S||e.animateIn(),T(),g.delay(1,function(){return y.enable()})):void 0}}(this)),t.$on("show.user.popup",function(e){return function(e,t){return c.resetTexture(),d.resetTexture(),a(v,!1),I(t.profilePicture)}}(this)),t.$on("userpopup.back.clicked",function(e){return function(){return h(),T(),y.enable()}}(this)),t.$on("popup.cycle.user",function(e){return function(e,t){switch(t.assetType){case"bottle":d.hideTransition(),c.showTransition();break;case"particle":c.hideTransition(),d.showTransition()}return I(t.profilePicture)}}(this)),$scope.$watch("enabled",function(e){return function(e,t){return e?void 0:y.disable()}}(this)),m(),setTimeout(function(e){return function(){return t.$emit("monument.ready")}}(this),10))}}}return e}(),angular.module("app").directive("monumentFallback",["$window","$rootScope","$location","GUI","lodash","ObjectLayout","Timeline","obeliskUsersService","userService","BackgroundObject","BottleZoomElement","ParticleZoomElement","Win","Detect","Settings","RAF","Utils",e])}.call(this),function(){var e;e=function(){function e(e,t,n,o,r,i,a,s,u,l,c,d,p,f,h,m,g,v,y,w){return{restrict:"A",scope:{enabled:"=enabled",userloggedin:"=userloggedin"},link:function(n,T){var E,b,x,M,P,H,A,R,k,S,I,B,C,j,O,D,U,Y,z,L,G,F,V,W,N,X,Z,q,Q,J,K,ee,te,ne,oe,re,ie,ae,se,ue,le,ce,de,pe,fe,he,me,ge,ve,ye,we,Te,Ee,be,xe,Me,Pe,He,Ae,Re,ke,Se,Ie,$e,Be,Ce,je,Oe,De,Ue,Ye,ze,Le,Ge,Fe,Ve,_e,We,Ne,Xe,Ze,qe,Qe,Je,Ke,et,tt,nt,ot,rt,it,at,st,ut,lt,ct,dt,pt,ft,ht,mt,gt,vt,yt,wt,Tt,Et,bt,xt,Mt,Pt,Ht;if(this.$scope=n,this.$element=T,env.WEBGL!==!1){for(ce=!1,Q=null,K=!0,we=null,Tt=!1,b=$(".register-form .left"),E=$(".obelisk-user"),Le=new ObjectDragIOWebgl($(".register-form .left, .obelisk-user"),v.device,g),oe=new DragIOWebgl(this.$element,v.device),p.user.position.set(0,0,50),ut=new THREE.WebGLRenderer({alpha:!0,antialias:!0,canvas:this.$element[0]}),ut.shadowMapEnabled=!0,ut.shadowMapType=THREE.PCFSoftShadowMap,ut.setSize(e.innerWidth,e.innerHeight),f.fog=l.fog,tt=u.all,xe=0,He=tt.length;He>xe;xe++)$e=tt[xe],f.add($e);for(fe=new THREE.GridHelper(50,10),pe=new THREE.AxisHelper(1e3),Y=new THREE.OrbitControls(p.dev,this.$element[0]),he=[Y],se=function(e){return i.find(Assets.all(),{id:e})},y.postProcessing&&(WAGNER.fragmentShadersPath="./js/fragment-shaders",WAGNER.assetsPath="./js/assets",U=new WAGNER.Composer(ut,{useRGBA:!0}),te=new WAGNER.DirtPass,Oe=new WAGNER.NoisePass,Oe.params.amount=.065,Oe.params.speed=10,Ht=new WAGNER.ZoomBlurPass,Ht.params.strength=.005,U.setSize(g.width,g.height),Ht.params.center.set(.5*U.width,.5*U.height)),G=function(){var e,t,n;return t=s.DomeMaterial.material,e=new THREE.SphereGeometry(6e3,60,40),n=new THREE.Mesh(e,t),n.receiveShadow=!1,n.scale.set(-1,1,1),n},F=function(){var e,t,n,o;return t=s.GroundMaterial.material,e=new THREE.PlaneBufferGeometry(1e3,1e3),n=new THREE.Mesh(e,t),n.receiveShadow=!0,n.rotation.x=-Math.PI/2,"1"===env.PHASE?n.position.set(0,230,0):(o=3.5,n.scale.set(o,o,o)),n},z=function(){var e,t,n;return t=s.BaseMaterial.material,e=se("Base").data,n=new THREE.Mesh(e,t),n.receiveShadow=!0,n.castShadow=!0,n},X=function(){var e,t,n,o;return o={color:16777215,wireframe:!0},e=se("Tower").data,t=new THREE.MeshLambertMaterial(o),n=new THREE.Mesh(e,t),n.visible=!1,n},V=function(){var e,t,n;return t=s.HatMaterial.material,e=se("Hat").data,n=new THREE.Mesh(e,t)},L=function(){var e,t,n,o,r,i,u,l,c;for(o=s.BottleMaterial.material,i=[],c=.42,e=se("Bottle").data,e.mergeVertices(),e.computeVertexNormals(),t=n=0,l=a.getTotalBottles();l>=0?l>n:n>l;t=l>=0?++n:--n)r=new THREE.Mesh(e,o),u=new THREE.Object3D,r.scale.set(c,c,c),r.castShadow=!0,r.name=""+t,r._d=r.position.clone(),r.phaseY=10*Math.random(),r.phaseZ=10*Math.random(),u.add(r),i.push(u);return i},N=function(){var e,t,n,o,r,i;for(e=s.ParticleMaterial,t=new THREE.Geometry,n=o=0,i=a.getTotalParticles();i>=0?i>o:o>i;n=i>=0?++o:--o)t.vertices.push(new THREE.Vector3);return r=new THREE.PointCloud(t,e.material),r.sortParticles=!0,r},Z=function(){var e,t,n,r,i,a,u;return t=se("BottleHighPoly").data,t.mergeVertices(),t.computeVertexNormals(),u=.42,e=new THREE.Object3D,a=new THREE.Object3D,n=new THREE.Mesh(t,s.BottleZoomMaterial.bottleMaterial),n.scale.set(u,u,u),n.castShadow=!0,t=new THREE.PlaneBufferGeometry(38,38,1,1),r=new THREE.Mesh(t,s.BottleZoomMaterial.photoMaterial),r.position.set(0,-1.5,6.4),i=Math.PI,o.add(a.rotation,"x",-i,i).name("rotation x"),o.add(a.rotation,"y",-i,i).name("rotation y"),o.add(a.rotation,"z",-i,i).name("rotation z"),a.add(r),a.add(n),e.add(a),e.visible=!1,e},q=function(){var e,t,n,r,i,a,u,l;return l=50,t=new THREE.Object3D,u=new THREE.Object3D,e=s.ParticleZoomMaterial,n=new THREE.PlaneBufferGeometry(l,l),r=new THREE.Mesh(n,e.particleMaterial),n=new THREE.PlaneBufferGeometry(31,31,1,1),i=new THREE.Mesh(n,e.photoMaterial),i.position.set(0,0,.1),a=50,o.add(i.position,"x",-a,a).name("position x"),o.add(i.position,"y",-a,a).name("position y"),o.add(i.position,"z",-a,a).name("position z"),u.add(i),u.add(r),t.add(u),t.visible=!1,t},Je=function(e){var t,n;return t=new THREE.SphereGeometry(5,8,8),n=new THREE.Mesh(t,new THREE.MeshBasicMaterial({color:16711680,wireframe:!0})),n.position.copy(e),f.add(n)},W=function(){var e;return e=new THREE.Mesh(new THREE.SphereGeometry(50,4,4),new THREE.MeshBasicMaterial(65280)),e.visible=!1,e},Ke=new THREE.Raycaster,Ke.params.PointCloud.threshold=6,et=new THREE.Vector2,ne=G(),le=F(),wt=X(),I=L(),S=Z(),Ze=N(),qe=q(),Fe=W(),f.add(ne),f.add(le),f.add(wt),f.add(Ze),f.add(qe),f.add(S),f.add(Fe),B=[],Me=0,Ae=I.length;Ae>Me;Me++)Ue=I[Me],B.push(Ue.children[0]);for(Ee=[Ze].concat(B),"1"!==env.PHASE&&(R=z(),de=V(),f.add(R),f.add(de)),Pe=0,Re=I.length;Re>Pe;Pe++)k=I[Pe],f.add(k);for(ve=se("MeshIndices").data.indices,J=[],je=0,ke=ve.length;ke>je;je++)pt=ve[je],J.push(pt[0]);for(gt=[],De=0,Se=ve.length;Se>De;De++)pt=ve[De],gt=gt.concat(pt);for(ve=gt,nt=wt.geometry.vertices,ge=Xe=0,Ie=nt.length;Ie>Xe;ge=++Xe)Mt=nt[ge],wt.geometry.vertices[ge]._d=new THREE.Vector3(Mt.x,Mt.y,Mt.z);return Ge=a.getOrder(),Be={},Qe=se("PathTower").data,mt=Qe.camera[0],re=Qe.camera[Qe.camera.length-1],dt=new THREE.Vector3(0,1,0),O=new THREE.Vector3(mt.x,mt.y,mt.z),j=new THREE.Vector3(re.x,re.y,re.z),D=25,C=env.PHASE1?400:600,ue=function(){var e,t,n,o,r;for(n=[],t=o=0,r=D;r>=0?r>o:o>r;t=r>=0?++o:--o)e=t/D,Mt=O.clone().lerp(j,e),Mt.z=C+1600*e*(1-Be.progress),Mt.applyAxisAngle(dt,p.rotationAngle),Je={x:Mt.x,y:Mt.y,z:Mt.z},n.push(Je);return n},h.setup(se("PathIntro").data),m.setup(se("PathTower").data,ue()),lt=function(){return Be={angle:.1,taper:.1,taperScale:.1,progress:.1}},lt(),Et=function(e){return function(){var e,t,n,o,i,a,s,u,l,c,d,p,f,h,g,v,y,w,T,E,b,x,M,P,H,A,R;for(r.angle(Be.angle),v=wt.geometry.vertices.length,c=ve.length,d=Math.floor(THREE.Math.mapLinear(Be.progress,0,1,0,c)),ge=E=0,p=ve.length;p>E;ge=++E)l=ve[ge],u=(ge-d)/c,u=THREE.Math.clamp(u,0,1),Mt=wt.geometry.vertices[l],Mt.set(Mt._d.x,Mt._d.y,Mt._d.z),T=r.twistAndTaper(Mt,ge,Be.taper,Be.taperScale,u);for(wt.geometry.verticesNeedUpdate=!0,b=0,t=0,y=0,g=new THREE.Vector3,n=new THREE.Vector3,e=new THREE.Vector3,M=wt.geometry.faces,ge=x=0,f=M.length;f>x;ge=++x)s=M[ge],h=600>ge||ge>=1200?ge%2===0:ge%2!==0,h&&(H=wt.geometry.vertices[s.a],A=wt.geometry.vertices[s.b],R=wt.geometry.vertices[s.c],o=(H.x+A.x+R.x)/3,i=(H.y+A.y+R.y)/3,a=(H.z+A.z+R.z)/3,n.subVectors(R,A),e.subVectors(H,A),n.cross(e),n.normalize(),g.x=o+50*n.x,g.y=i+50*n.y,g.z=a+50*n.z,P=Ge[b],"bottle"===P?(k=I[t],k.position.set(o,i,a),k.lookAt(g),t++):(Ze.geometry.vertices[y].set(o,i,a),y++),b++),Ze.geometry.verticesNeedUpdate=!0;return w=ue(),m.updatePoints(w)}}(this),this.animateIn=function(e,n){var o,r;return null==e&&(e=5),null==n&&(n=!1),we.totalProgress(1).kill(),K=!1,t.$emit("on.transition.in"),r=se("PathIntro").data.camera,r.pop(),r.push(m.getPointOnCameraPath(0)),h.updatePoints(r),p.positionY=0,o={positionY:1,onUpdate:function(e){return function(){return h.updateCameraPosition(p.positionY),Ce(1-p.positionY)}}(this),onComplete:function(e){return function(){return Tt=!0,n?ie():void 0}}(this)},TweenMax.to(p,e,o)},this.animateInToUserObject=function(e){var n,o,r,i,a,s;switch(null==e&&(e=!0),t.$emit("on.transition.in"),Tt=!1,s=userService.get(),o=parseInt(s.occurance),s.assetType){case"bottle":i=I[o].position;break;case"particle":i=Ze.geometry.vertices[o]}return a=i.y,a=a.map(O.y,j.y,0,1),a=THREE.Math.clamp(a,0,1),K&&(p.positionY=0,m.updateCameraPosition(0)),r={positionY:a,delay:1,onUpdate:function(e){return function(){var e;return p.rotationAngle=oe.rotation.x,e=ue(),m.updatePoints(e),m.updateCameraPosition(p.positionY),Ce(p.positionY)}}(this),onComplete:function(t){return function(){return oe.rotation.y=p.positionY,Tt=!0,ie(e)}}(this)},n=.5+5*a,TweenMax.to(p,n,r),K=!1},ft=o.addFolder("shape"),P=10,ft.add(Be,"angle",-P,P).onChange(Et),ft.add(Be,"taper",0,.2).onChange(Et),ft.add(Be,"taperScale",0,2).onChange(Et),ft.add(Be,"progress",0,1).onChange(Et),ft.add(this,"animateIn"),Pt=function(e,t){return e.position.set(1*t,.75*t,1*t),e.lookAt(new THREE.Vector3)},ae=function(e){var t,n;return null==e&&(e=!1),t=e?60:65,n={fov:t,ease:Quad.easeOut,onUpdate:function(e){return function(){return p.user.updateProjectionMatrix()}}(this)},TweenMax.to(p.user,.8,n)},H=function(e,t){var n,o,r,i,a,u;return null==t&&(t=!0),Tt&&l.fadeIn(),ae(!0),t?Le.setActiveElement(b,t):Le.setActiveElement(E,t),Le.enable(),d.update(p.user),i=d.getScreenPositionData(),r=i.position,a=i.lookat,u=i.transition,"particle"===e.objectType?(s.ParticleMaterial.hideParticle(e.intersectionIndex),o=.27,Fe.position.copy(r),Fe.lookAt(a),qe.visible=!0,S.visible=!1,s.ParticleZoomMaterial.resetOpacity(),qe.lookAt(Fe),e.animateFromPosition?(qe.scale.set(o,o,o),qe.position.copy(e.intersectionPoint),qe.lookAt(p.user.position),n={x:r.x,y:r.y,z:r.z,onUpdate:function(e){return function(){return qe.lookAt(a)}}(this)},TweenMax.to(qe.position,1,n),n={x:1,y:1,z:1},TweenMax.to(qe.scale,1,n)):(qe.position.copy(r),qe.lookAt(a),qe.scale.set(1,1,1),qe.position.copy(u),n={x:r.x,y:r.y,z:r.z},TweenMax.to(qe.position,1,n)),S.position.copy(r),S.lookAt(a)):(e.object.visible=!1,S.position.copy(e.object.parent.position),S.rotation.copy(e.object.parent.rotation),Fe.position.copy(r),Fe.lookAt(a),qe.visible=!1,S.visible=!0,s.BottleZoomMaterial.fadeIn(),e.animateFromPosition?(S.rotation.y<Math.PI&&(S.rotation.y+=Math.PI),n={x:r.x,y:r.y,z:r.z,onUpdate:function(e){return function(){return S.lookAt(a)}}(this)},TweenMax.to(S.position,1,n),n={y:Fe.rotation.y},TweenMax.to(S.rotation,1,n)):(S.position.copy(u),S.lookAt(a),n={x:r.x,y:r.y,z:r.z},TweenMax.to(S.position,1,n)),qe.position.copy(r),qe.lookAt(a)),oe.disable()},A=function(){var e,t,n,o,r,i;if(null!=Q)return ae(!1),Le.disable(),o=d.getScreenPositionData(),n=o.position,r=o.lookat,i=o.transition,"particle"===Q.objectType?(t={x:i.x,y:i.y,z:i.z},TweenMax.to(qe.position,1,t)):(t={x:i.x,y:i.y,z:i.z},TweenMax.to(S.position,1,t),Q.object.visible=!0),e=S.children[0],TweenMax.killTweensOf(e),TweenMax.to(e.rotation,.6,{x:0,y:0,z:0}),e=qe.children[0],TweenMax.killTweensOf(e),TweenMax.to(e.rotation,.6,{x:0,y:0,z:0}),s.ParticleZoomMaterial.fadeOut(),s.BottleZoomMaterial.fadeOut(),angular.equals(w.getUriSegment(1),"explore")?oe.enable():void 0},be=!1,ht=function(e){var t,n;return Q=e,be=!0,n=w.toScreenPosition(Q.intersectionPoint.clone(),p.user),t={user:Q.index,position:n,objectType:Q.objectType,occurance:Q.occurance},this.$scope.$emit("monument.showTooltip",t)},ot=function(){var e,t;if(null==Q)switch(t=obeliskUsersService.getRandomDataForRegistration().occurance,e=obeliskUsersService.getRandomDataForRegistration().assetType){case"particle":Q={point:Ze.geometry.vertices[t],objectType:e,objectIndex:t,animateFromPosition:!1};break;case"bottle":Q={object:I[t].children[0],objectType:e,objectIndex:t,animateFromPosition:!1}}return H(Q)},rt=function(){return A()},it=function(){return H(Q)},xt=function(e,t){return null==t&&(t=.5),s.BottleZoomMaterial.updatePhotoTexture(e,t),s.ParticleZoomMaterial.updatePhotoTexture(e,t)},me=function(){return be=!1,this.$scope.$emit("monument.hideTooltip")},Te=function(e){return function(){var e,t,n,o,r,i,s,u,l,c,d,f,h,m;if(oe.enabled){if(et.x=oe.normalX,et.y=oe.normalY,Ke.setFromCamera(et,p.user),r=Ke.intersectObjects(Ee),o=r.length>0?r[0]:null,null!=o)if(d=a.getOrder(),null!=o.face){for(l="bottle",e=parseInt(o.object.name),n=0,c=0,ge=h=0,i=d.length;i>h;ge=++h){if(Ue=d[ge],Ue===l){if(e===c)break;c++}n++}u=n}else{for(l="particle",f=o.index,n=0,c=0,ge=m=0,s=d.length;s>m;ge=++m){if(Ue=d[ge],Ue===l){if(f===c)break;c++}n++}u=n}return o?(ce=!0,t={point:wt.geometry.vertices[u].clone(),index:u,objectType:l,object:o.object,animateFromPosition:!0,intersectionPoint:o.point.clone(),intersectionIndex:o.index,occurance:c},ht(t)):(ce=!1,me())}}}(this),Ve=function(e){return function(){return t.$emit("mouse.down")}}(this),_e=function(e){return function(){return t.$emit("mouse.up")}}(this),We=function(e){return function(e){var t,n,o,r,i,a,s,u,l,c,d;return r=e.x,i=e.y,n=qe.children[0].children[1],a=Math.PI/8,TweenMax.killTweensOf(n),d=r.map(0,1,-a,a),o={z:d},TweenMax.to(n.rotation,.9,o),r=e.x,i=e.y,t=S.children[0],s=Math.PI/8,u=Math.PI/6,TweenMax.killTweensOf(t),l=i.map(0,1,-s,s),c=r.map(0,1,-u,u),o={x:l,y:c},TweenMax.to(t.rotation,.6,o)}}(this),Ne=function(){var e,t,n;return t=qe.children[0].children[1],TweenMax.killTweensOf(t),n={z:0},TweenMax.to(t.rotation,.6,n),e=S.children[0],TweenMax.killTweensOf(e),n={x:0,y:0},TweenMax.to(e.rotation,.6,n)},ie=function(e){var t,n;if(n=userService.get()){switch(n.assetType){case"bottle":t=parseInt(n.occurance),Q={object:I[t].children[0],objectType:"bottle",objectIndex:t,animateFromPosition:!0};break;case"particle":t=parseInt(n.occurance),Q={point:Ze.geometry.vertices[t],objectType:"particle",objectIndex:t,animateFromPosition:!0,intersectionPoint:Ze.geometry.vertices[t]}}return xt(userService.get().profilePicture),H(Q,e)}},M=250,x=1e3,Ce=function(e){return u.point.position.y=w.lerp(M,x,e)},yt=I.length,vt=new THREE.Vector3,ee=0,bt=function(){var e,t,n,o,r,i,a,s,u,l,c;for(ee+=.01,Tt&&(oe.update(),p.rotationAngle=oe.rotation.x,p.positionY=oe.rotation.y,a=ue(),m.updatePoints(a),m.updateCameraPosition(p.positionY),Ce(p.positionY)),ge=s=0,l=yt;l>=0?l>s:s>l;ge=l>=0?++s:--s)e=I[ge].children[0],t=e._d,r=e.phaseY,i=e.phaseZ,vt.set(t.x,t.y,t.z),vt.y+=5*Math.sin(ee+r),I[ge].children[0].position.set(vt.x,vt.y,vt.z);for(d.update(p.user),c=[],u=0,o=he.length;o>u;u++)n=he[u],c.push(n.update());return c},st=function(t,n,o,r,i){return r=e.innerWidth,i=e.innerHeight,n*=r,o*=i,r*=r,i*=i,ut.setScissor(n,o,r,i),ut.render(f,t),y.postProcessing?(U.reset(),U.render(f,t),U.pass(te),U.pass(Oe),U.toScreen()):void 0},ct=function(){var e;return e=g.width/g.height,p.dev.aspect=e,p.user.aspect=e,p.dev.updateProjectionMatrix(),p.user.updateProjectionMatrix(),y.postProcessing&&(U.setSize(g.width,g.height),Ht.params.center.set(.5*U.width,.5*U.height)),ut.setSize(g.width,g.height)},at=function(e){return function(){return requestAnimationFrame(at),bt(),ut.enableScissorTest(!1),ut.clear(),ut.enableScissorTest(!0),p.debug?(st(p.user,0,0,.25,.25),st(p.dev,0,0,1,1)):(st(p.dev,0,0,.25,.25),st(p.user,0,0,1,1))}}(this),ye=function(){var e,t,n;return n={percent:0},e=w.lerp(4,15,c.percent),"1"!==env.PHASE&&s.HatMaterial.hide(),s.HatMaterial.fadeIn(8),t={percent:c.percent,ease:Quad.easeInOut,onUpdate:function(e){return function(){return Be.angle=w.lerp(10,0,n.percent),Be.taper=w.lerp(.1,0,n.percent),Be.taperScale=w.lerp(.11,0,n.percent),Be.progress=n.percent,Et(),h.updateCameraPosition(0)}}(this),onComplete:function(e){return function(){}}(this)},we=TweenLite.to(n,e,t)},t.$on("register.upload.photo",function(e){return function(e,t){return xt(t.image)}}(this)),t.$on("register.back.clicked",function(e){return function(){return A(),l.fadeOut()}}(this)),t.$on("register.complete",function(e){return function(){return rt()}}(this)),t.$on("mobile.register.prev.state",function(e){return function(){return it()}}(this)),t.$on("mobile.register.next.state",function(e){return function(){return rt()}}(this)),t.$on("show.user.popup",function(e){return function(e,t){return console.debug("show.user.popup -->",t),s.BottleZoomMaterial.resetTexture(),s.ParticleZoomMaterial.resetTexture(),H(Q,!1),xt(t.profilePicture)}}(this)),t.$on("userpopup.back.clicked",function(e){return function(){return A(),l.fadeOut()}}(this)),ze=function(e){var t,n;return n=d.getScreenPositionData().lookatMarker,t={x:n.x,y:n.y,z:n.z},TweenMax.to(e.position,1,t)},Ye=function(e){var t,n;return n=d.getScreenPositionData(),e.position.copy(n.transition),t={x:n.position.x,y:n.position.y,z:n.position.z},TweenMax.to(e.position,1,t)},t.$on("popup.cycle.user",function(e){return function(e,t){switch(t.assetType){case"bottle":S.visible?(ze(S),s.BottleZoomMaterial.hideTransition(function(){return Ye(S),S.visible=!0,s.BottleZoomMaterial.showTransition()})):(ze(qe),s.ParticleZoomMaterial.hideTransition(function(){return qe.visible=!1,Ye(S),S.visible=!0,s.BottleZoomMaterial.showTransition()}));break;case"particle":qe.visible?(ze(qe),s.ParticleZoomMaterial.hideTransition(function(){return Ye(qe),qe.visible=!0,s.ParticleZoomMaterial.showTransition()})):(ze(S),s.BottleZoomMaterial.hideTransition(function(){return S.visible=!1,Ye(qe),qe.visible=!0,s.ParticleZoomMaterial.showTransition()}))}return xt(t.profilePicture,1.1)}}(this)),t.$on("$locationChangeStart",function(e){return function(t){var n;return n=w.getPath().split("/")[1],angular.equals(n,"join")&&Tt&&l.fadeIn(),angular.equals(n,"")&&(l.fadeOut(),A()),angular.equals(n,"register")&&(we.totalProgress(1).kill(),l.fadeIn(),e.$scope.userloggedin===!1&&(s.BottleZoomMaterial.resetTexture(),s.ParticleZoomMaterial.resetTexture(),ot())),angular.equals(n,"explore")?l.fadeOut():void 0}}(this)),$scope.$watch("enabled",function(e){return function(t,n){return t?oe.enable():oe.disable(),t?_.isNumber(w.getDeeplinkUserIndex())&&null!=userService.get()?(we.totalProgress(1).kill(),e.animateInToUserObject(!1)):angular.equals(w.getUriSegment(1),"explore")&&!Tt?e.animateIn():void 0:void 0}}(this)),Pt(p.dev,600),ye(),g.on("resize",ct),Le.on("drag",We),Le.on("release",Ne),oe.on("mousedown",Ve),oe.on("mouseup",_e),setTimeout(function(e){return function(){return at(),t.$emit("monument.ready"),animateIn()}}(this),10)}}}}return e}(),angular.module("app").directive("monumentWebgl",["$window","$rootScope","$location","GUI","TwistModifier","lodash","ObjectLayout","Materials","Lights","Fog","Timeline","ObjectZoomHelper","Cameras","Scene","IntroPath","TowerPath","Win","Detect","Settings","Utils",e])}.call(this),function(){var e,t;e=function(){function e(e,t){var n,o;return o=e.defer(),n=o.promise,t.onYouTubeIframeAPIReady=function(){o.resolve()},{onReady:function(e){return n.then(e)}}}return e}(),t=function(){function e(e,t,n){return{restrict:"E",scope:{height:"@",width:"@",videoid:"@"},template:"<div></div>",link:function(e,o,r){var i,a,s,u,l,d,p,f,h;return l=void 0,h=n.get("youtubeVideoName"),i={STOP:0,PLAY:1,PAUSE:2,STATUS_CHANGE:3},p=document.createElement("script"),a=null,u=!1,f=function(){return u?void 0:l.getCurrentTime()>l.getDuration()/2?(c.debug("ga('send', 'event', '"+h+"','video_player','play_50')"),ga("send","event",h,"video_player","play_50"),u=!0):void 0},d=function(e,t){return new YT.Player(t.children()[0],{playerVars:{autoplay:0,html5:1,theme:"light",modesbranding:0,color:"white",iv_load_policy:3,showinfo:0,controls:1},height:e.height,width:e.width,videoId:e.videoid,events:{onStateChange:function(t){var n;switch(n={event:i.STATUS_CHANGE,data:""},t.data){case YT.PlayerState.PLAYING:n.data="PLAYING",c.debug("ga('send', 'event', '"+h+"','video_player','start')"),ga("send","event",h,"video_player","start"),a=setInterval(f,500);break;case YT.PlayerState.ENDED:n.data="ENDED",c.debug("ga('send', 'event', '"+h+"','video_player','play_100')"),ga("send","event",h,"video_player","play_100"),clearInterval(a),u=!1;break;case YT.PlayerState.UNSTARTED:n.data="NOT PLAYING";break;case YT.PlayerState.PAUSED:n.data="PAUSED",c.debug("ga('send', 'event', '"+h+"','video_player','pause')"),ga("send","event",h,"video_player","pause"),clearInterval(a)}e.$apply(function(){e.$emit(n.event,n.data)})}}})},p.src="https://www.youtube.com/iframe_api",s=document.getElementsByTagName("script")[0],s.parentNode.insertBefore(p,s),t.onReady(function(){l=d(e,o)}),e.$watch("height + width",function(t,n){t!==n&&l.setSize(e.width,e.height)}),e.$watch("videoid",function(t,n){t!==n&&l.cueVideoById(e.videoid)}),e.$on(i.STOP,function(){l.seekTo(0),l.stopVideo()}),e.$on(i.PLAY,function(){console.log("RECEIVING"),l.playVideo()}),e.$on(i.PAUSE,function(){l.pauseVideo()}),$(".btn-play").click(function(){return l.playVideo(),$(".btn-play").hide()})}}}return e}(),angular.module("app").service("youTubeApiService",["$q","$window",e]).directive("youtubeEmbed",["$window","youTubeApiService","Dictionary",t])}.call(this),function(){var e,t,n,o,r;o=new(o=function(){function e(){var e;return e=function(e){var t;return t=new Promise(function(t,n){var o;return o=$.ajax(e.url,{type:"get"}),o.success(function(n){return e.data=n,t(e)}),o.error(function(e){return n(e)})})},{load:e}}return e}()),r=new(r=function(){function e(){var e;return e=function(e){var t;return t=new Promise(function(t,n){var o;return o=$.ajax(e.url,{type:"get"}),o.success(function(n){return e.data=n,t(e)}),o.error(function(e){return n(e)})})},{load:e}}return e}()),t=new(t=function(){function e(){var e;return e=function(e){var t;return t=new Promise(function(t,n){var o;return o=new THREE.JSONLoader,o.load(e.url,function(o){return function(o){return null!=o?(e.data=o,t(e)):n("failed to load geometry: "+e.id)}}(this))})},{load:e}}return e}()),n=new(n=function(){function e(){var e;return e=function(e){var t;return t=new Promise(function(t,n){var o;return o=new Image,o.onload=function(n){return function(){return e.data=o,t(e)}}(this),o.onerror=function(t){return function(t){return n("Failed to load image: "+e.url)}}(this),o.src=e.url})},{load:e}}return e}()),window.AssetLoader=new(e=function(){function e(){var e,i;return e=null,i=function(e){var i,a,s,u,l,c,d;for(d=e.length,a=new Date,l=[],s=0,u=e.length;u>s;s++)switch(i=e[s],i.type){case"json":l.push(o.load(i));break;case"xml":l.push(r.load(i));break;case"image":l.push(n.load(i));break;case"geometry":l.push(t.load(i))}return c=new Promise(function(e,t){return Promise.all(l).then(function(t){return e(t)},function(e){return t(e)})})},{load:i}}return e}())}.call(this),function(){var e;window.Assets=new(e=function(){function e(){var e,t,n,o,r,i,a;return r=[{id:"Dictionary",url:"/xml/"+env.LOCALE+"/Dictionary.xml",type:"xml"}],a=function(){var e,t;return e=[{id:"MeshIndices",url:"/webgl-assets/data/MeshIndices.json",type:"json"},{id:"PathIntro",url:"/webgl-assets/data/PathIntro.json",type:"json"},{id:"PathTower",url:"/webgl-assets/data/PathTower.json",type:"json"},{id:"Tower",url:"/webgl-assets/models/Tower2.js",type:"geometry"},{id:"Bottle",url:"/webgl-assets/models/Bottle.js",type:"geometry"},{id:"BottleHighPoly",url:"/webgl-assets/models/BottleHighPoly.js",type:"geometry"},{id:"Particle",url:"/webgl-assets/textures/Particle.png",
type:"image"},{id:"FloorTexture",url:"/webgl-assets/textures/FloorTexture.jpg",type:"image"},{id:"SkyTexture",url:"/webgl-assets/textures/SkyTexture.jpg",type:"image"},{id:"FloorTextureBump",url:"/webgl-assets/textures/FloorTextureBump.jpg",type:"image"},{id:"BottleTexture",url:"/webgl-assets/textures/BottleTexture.jpg",type:"image"},{id:"ProfilePicture",url:"/webgl-assets/textures/ProfilePicture.jpg",type:"image"},{id:"BottleAlphaMap",url:"/webgl-assets/textures/BottleAlphaMap.jpg",type:"image"},{id:"ParticleAlphaMap",url:"/webgl-assets/textures/ParticleAlphaMap.jpg",type:"image"}],t=[{id:"Base",url:"/webgl-assets/models/Base.js",type:"geometry"},{id:"Hat",url:"/webgl-assets/models/Hat.js",type:"geometry"},{id:"BaseTexture",url:"/webgl-assets/textures/BaseTexture.jpg",type:"image"},{id:"BaseTextureBump",url:"/webgl-assets/textures/BaseTextureBump.jpg",type:"image"},{id:"HatTexture",url:"/webgl-assets/textures/HatTexture.jpg",type:"image"}],e=e.concat(t)},e=function(e){return r=r.concat(e)},n=function(){var e;return e=[{id:"Bottle",url:"/fallback-assets/textures/BottleMaterial.png",type:"image"},{id:"Particle",url:"/fallback-assets/textures/ParticleMaterial.png",type:"image"},{id:"BottleAlphaMap",url:"/fallback-assets/textures/BottleMaterialAlphaMask.png",type:"image"},{id:"ParticleAlphaMap",url:"/fallback-assets/textures/ParticleMaterialAlphaMask.png",type:"image"}]},e(env.WEBGL?a():n()),t=function(){return r},i=function(e){return r=e},o=function(e){return _.find(r,{id:e})},{all:t,update:i,getAsset:o}}return e}())}.call(this),function(){var e;e=function(){function e(){var e,t,n,o,r,i;return n=new MobileDetect(window.navigator.userAgent),o=_.isString(n.mobile())?!0:!1,i=_.isString(n.tablet())?!0:!1,t=o||i,e=o===!1&&i===!1?!0:!1,i&&(o=!1),r=o===!1,{mobile:o,tablet:i,desktop:e,notMobile:r,device:t,firefox:bowser.firefox,ie:bowser.msie,version:bowser.version}}return e}(),angular.module("app").factory("Detect",[e])}.call(this),function(){var e;e=function(){function e(){var e,t;return e=$(Assets.getAsset("Dictionary").data),t=function(t){return e.find(t).length?e.find(t).text():"Dictionary field doesn't exist."},{get:t}}return e}(),angular.module("app").factory("Dictionary",[e])}.call(this),function(){var e;e=function(){function e(){var e,t,n,o;return n=env.GUI,e=function(){function e(){}return e.prototype.add=function(){return this},e.prototype.listen=function(){return this},e.prototype.name=function(){return this},e.prototype.open=function(){return this},e.prototype.onChange=function(){return this},e.prototype.addFolder=function(){return new e},e.prototype.addColor=function(){return this},e}(),t=function(){function t(){}return t.prototype.add=function(){return this},t.prototype.addFolder=function(){return new e},t.prototype.name=function(){return this},t.prototype.close=function(){return this},t.prototype.step=function(){return this},t.prototype.onChange=function(){return this},t.prototype.setValue=function(){return this},t.prototype.listen=function(){return this},t}(),n?(o=new dat.GUI({width:350}),o.close()):o=new t,o}return e}(),angular.module("app").factory("GUI",[e])}.call(this),function(){var e;e=function(){function e(){var e,o,r,i;return o={},Happens(o),r=function(){return n?void 0:(n=!0,t=window.requestAnimationFrame(e))},i=function(){return window.cancelAnimationFrame(t),t=null,n=!1},e=function(n){return function(){return t=window.requestAnimationFrame(e),o.emit("tick")}}(this),{event:o,start:r,stop:i}}var t,n;return t=null,n=!1,e}(),angular.module("app").factory("RAF",[e])}.call(this),function(){var e;e=function(){function e(e,t){var n,o;return n=768,o=1025,this.mobile=!1,this.tablet=!1,this.desktop=!1,this.orientation="portrait",this.landscape=!1,this.portrait=!1,this.resize=function(e){return function(){return e.mobile=!1,e.tablet=!1,e.desktop=!1,t.width<n?e.mobile=!0:t.width<o?e.tablet=!0:e.desktop=!0,{mobile:e.mobile,tablet:e.tablet,desktop:e.desktop}}}(this),this.orientationchange=function(e){return function(){var t;return t=window.orientation||window.mozOrientation||window.msOrientation||0,t=Math.abs(t),90===t?(e.orientation="landscape",e.landscape=!0,e.portrait=!1):(e.orientation="portrait",e.portrait=!0,e.landscape=!1)}}(this),t.on("resize",this.resize),t.on("orientationchange",this.orientationchange),this.resize(),this.orientationchange(),this}return e}(),angular.module("app").factory("Responsive",["$window","Win",e])}.call(this),function(){var e;e=function(){function e(e,t){var n,o,r;return this.percent=0,this.startTime="",this.endTime="",this.nowTime="",this.duration=10,o=e.addFolder("timeline"),o.open(),r=moment(env.TIMELINE.START,"YYYY-MM-DD HH:mm:ss"),n=moment(env.TIMELINE.END,"YYYY-MM-DD HH:mm:ss"),o.add(this,"startTime").listen(),o.add(this,"endTime").listen(),o.add(this,"nowTime").listen(),o.add(this,"percent",0,1).listen(),this.startTime=r._d,this.endTime=n._d,this.startUpdate=function(){return t.start()},this.stopUpdate=function(){return t.stop()},this.playTransition=function(e){return function(){var t,o,i,a,s;return e.stopUpdate(),o=e.startTime,t=e.endTime,s=moment().seconds(0),i=moment(s).add(1,"minute"),r=s.format("YYYY-MM-DD HH:mm:ss"),n=i.format("YYYY-MM-DD HH:mm:ss"),e.percent=0,a={percent:1,ease:Linear.easeNone,onComplete:function(){return r=o,n=t,e.startUpdate()}},TweenLite.to(e,e.duration,a)}}(this),this.stopTransition=function(e){return function(){}}(this),this.update=function(e){return function(){var t,o,i;return o=moment(),e.now=o.unix(),i=r.unix(),t=n.unix(),e.percent=(e.now-i)/(t-i),e.percent=THREE.Math.clamp(e.percent,0,1),"1"!==env.PHASE&&(e.percent=1),e.percent=0}}(this),o.add(this,"playTransition"),o.add(this,"stopTransition"),this.update(),this.startUpdate(),this}return e}(),angular.module("app").factory("Timeline",["GUI","RAF",e])}.call(this),function(){var e;e=function(){function e(e,t,n,o){var r,i,a,s,u,l,c,d,p;return l=!1,r=!1,c=function(e){return function(e){return l=e}}(this),a=function(e){return function(){return l}}(this),p=o.getPath().split("/")[2],null!=p&&(i=n.getUserByIndex(parseInt(p)),c(i)),s=function(){return window.location.origin+"/"+env.LOCALE+"/explore/"+l.index},u=function(){return r},d=function(){return r=!0},{set:c,get:a,isRegistered:u,setRegistered:d,getShareUrl:s}}return e}(),angular.module("app").service("userService",["$rootScope","$location","obeliskUsersService","Utils",e])}.call(this),function(){var e;e=function(){function e(e){var t,n;return Happens(this),this.width=0,this.height=0,t=$(e),this.width=t.width(),this.height=t.height(),n=function(e){return function(n){return e.width=t.width(),e.height=t.height(),e.emit("resize")}}(this),t.on("resize",n),n(),this}return e}(),angular.module("app").factory("Win",["$window",e])}.call(this),function(){var e=[].slice;window.c={enable:!1,clear:function(){return"undefined"!=typeof console&&null!==console&&null!=console.clear?console.clear():void 0},log:function(){var t;return t=1<=arguments.length?e.call(arguments,0):[],this.enable?"undefined"!=typeof console&&null!==console&&null!=console.log&&null!=console.log.apply?console.log.apply(console,t):console.log(t):void 0},debug:function(){var t;return t=1<=arguments.length?e.call(arguments,0):[],this.enable?"undefined"!=typeof console&&null!==console&&null!=console.debug&&null!=console.debug.apply?console.debug.apply(console,t):console.log(t):void 0},info:function(){var t;return t=1<=arguments.length?e.call(arguments,0):[],this.enable?"undefined"!=typeof console&&null!==console&&null!=console.info&&null!=console.info.apply?console.info.apply(console,t):console.log(t):void 0},warn:function(){var t;return t=1<=arguments.length?e.call(arguments,0):[],this.enable?"undefined"!=typeof console&&null!==console&&null!=console.warn&&null!=console.warn.apply?console.warn.apply(console,t):console.log(t):void 0},error:function(){var t;return t=1<=arguments.length?e.call(arguments,0):[],this.enable?"undefined"!=typeof console&&null!==console&&null!=console.error&&null!=console.error.apply?console.error.apply(console,t):console.log(t):void 0}}}.call(this),function(){var e;e=function(){function e(e){e.html5Mode(!0)}return e}(),angular.module("app").config(["$locationProvider",e])}.call(this),function(){var e;e=function(){function e(){var e;return e=function(){var e,t,n,o,r;return n=env.COUNTDOWN,t=moment(),e=n.split("-"),r=moment([t.year(),t.month(),t.date()]),o=moment([e[0],e[1]-1,e[2]]),o.diff(r,"days")},{getCountdown:e}}return e}(),angular.module("app").service("dataService",[e])}.call(this),function(){var e;e=function(){function e(e,t){var n,o,r;return this.dev=new THREE.PerspectiveCamera(65,t.innerWidth/t.innerHeight,.1,1e5),this.user=new THREE.PerspectiveCamera(65,t.innerWidth/t.innerHeight,.1,1e5),o=100,this.debug=!1,this.rotationAngle=0,this.positionY=1,this.scaleXZ=1,Happens(this),r=function(e){return function(){return e.user.updateProjectionMatrix()}}(this),n=e.addFolder("camera"),n.add(this,"debug"),n.add(this,"rotationAngle",-Math.PI,Math.PI).listen(),n.add(this,"positionY",0,1).listen(),n.add(this,"scaleXZ",0,1e3).onChange(function(e){return function(){return e.emit("rotate")}}(this)),n.add(this.user.position,"x",-o,o),n.add(this.user.position,"y",-o,o),n.add(this.user.position,"z",-o,o),n.open(),this}return e}(),angular.module("app").factory("Cameras",["GUI","$window",e])}.call(this),function(){var e;window.DragIOWebgl=e=function(){function e(e,t){var n,o,r,i,a,s,u,l,c,d,p,f,h;Happens(this),this.mouseX=0,this.mouseY=0,this.mouseLastX=0,this.mouseLastY=0,this.normalX=0,this.normalY=0,this.normalCenterX=.1,this.normalCenterY=.1,this.clickedX=0,this.clickedY=0,this.relativeX=0,this.relativeY=0,this.isDown=!1,o="",r="",this.velocityX=0,this.velocityY=0,this._velocityX=0,this._velocityY=0,this.positionY=0,this.rotation={x:0,y:0},this.isDragging=!1,this.enabled=!1,n=null,this.desktopMousemoveEnabled=!0,f=t?5:1,h=t?.05:.009,a=function(t){return function(n){return t.clickedX=n.clientX,t.clickedY=n.clientY,t.normalX=n.clientX/window.innerWidth*2-1,t.normalY=2*-(n.clientY/window.innerHeight)+1,e.removeClass("dragging"),t.emit("click")}}(this),u=function(e){return function(){return e.enabled?e.emit("mousedown"):void 0}}(this),c=function(t){return function(){return e.removeClass("dragging"),t.enabled?t.emit("mouseup"):void 0}}(this),p=function(t){return function(n){return e.addClass("dragging"),t.desktopMousemoveEnabled=!1,t.isDown=!0,TweenMax.killTweensOf(t),t.clickedX=n.center.x,t.clickedY=n.center.y,t.relativeX=0,t.relativeY=0}}(this),d=function(t){return function(o){var r;return e.removeClass("dragging"),t.isDown=!1,TweenMax.killTweensOf(t),r={_velocityX:0,_velocityY:0},TweenMax.to(t,1,r),clearInterval(n),n=setTimeout(function(){return t.desktopMousemoveEnabled=!0},1500)}}(this),s=function(e){return function(t){return e.isDragging=t.distance>0?!0:!1,o=2===t.direction?"left":"right",e.velocityX=t.velocityX*f,e.velocityY=t.deltaY/200,e.velocityY=THREE.Math.clamp(e.velocityY,-1,1),e._velocityY=e.velocityY*h,e.mouseLastX=e.mouseX,e.mouseLastY=e.mouseY,e.mouseX=t.center.x,e.mouseY=t.center.y,e.relativeX=e.mouseX-e.clickedX,e.relativeY=e.mouseY-e.clickedY,o=e.mouseX>e.clickedX?"right":"left",r=e.mouseY>e.clickedY?"up":"down"}}(this),l=function(e){return function(t){return e.enabled&&!e.isDown&&e.desktopMousemoveEnabled?(e.clickedX=t.clientX,e.clickedY=t.clientY,e.normalX=t.clientX/window.innerWidth*2-1,e.normalY=2*-(t.clientY/window.innerHeight)+1,e.emit("mousemove")):void 0}}(this),this.update=function(e){return function(){return e.isDown&&(e._velocityX=.025*e.velocityX),e.rotation.x+=e._velocityX,e.rotation.y+=e._velocityY,e.rotation.y=THREE.Math.clamp(e.rotation.y,0,1)}}(this),this.enable=function(){return this.enabled=!0},this.disable=function(){return this.enabled=!1},i=new Hammer(e.get(0)),i.get("pan").set({direction:Hammer.DIRECTION_ALL}),i.on("panstart",p),i.on("panend",d),i.on("hammer.input",s),e.on("click",a),e.on("mousedown",u),e.on("mousemove",l),e.on("mouseup",c)}return e}()}.call(this),function(){var e;e=function(){function e(e,t,n){var o,r,i,a,s,u,l,c,d,p,f;return r=2e-4,i=.00226,o=1,s={percent:0,fog:.002},c=new THREE.FogExp2(0,r),d=e.addFolder("fog"),d.add(c,"density",0,.01).listen(),d.add(s,"percent",0,1).listen(),d.add(s,"fog",0,.1),u=function(){var e;return e={percent:1,onUpdate:function(e){return function(){return p()}}(this)},TweenMax.to(s,o,e)},l=function(){var e;return e={percent:0,onUpdate:function(e){return function(){return p()}}(this)},TweenMax.to(s,o,e)},f=new THREE.Vector3,a=new THREE.Vector3,p=function(){var e,n;return a.set(t.user.position.x,0,t.user.position.z),e=a.distanceTo(f),n=1-e/3500,n=THREE.Math.clamp(n,0,1),c.density=n*s.fog*s.percent},{fog:c,fadeIn:u,fadeOut:l,update:p}}return e}(),angular.module("app").factory("Fog",["GUI","Cameras","Utils",e])}.call(this),function(){var e;e=function(){function e(e){var t,n,o,r,i,a,s,u,l,c;return s={ambient:{color:65793},directional:{color:14603468,position:{x:-1e3,y:500,z:1e3}},directional2:{color:7310475,position:{x:-10,y:10,z:-10}},point:{color:7097407,position:{x:0,y:0,z:0}}},n=new THREE.AmbientLight(s.ambient.color),r=new THREE.DirectionalLight(s.directional.color,1),i=new THREE.DirectionalLight(s.directional2.color,1),l=new THREE.PointLight(s.point.color,4,500),t=[n,r,i,l],u=["ambient","directional","directional2","point"],r.castShadow=!0,r.position.set(s.directional.position.x,s.directional.position.y,s.directional.position.z),i.position.set(s.directional2.position.x,s.directional2.position.y,s.directional2.position.z),l.position.set(s.point.position.x,s.point.position.y,s.point.position.z),r.position.set(-1e3,500,1e3),i.position.set(-1e3,1e3,-1e3),a=e.addFolder("lights"),c=function(){var e,n,o,r,i;for(i=[],e=n=0,o=t.length;o>n;e=++n)r=t[e],i.push(r.color.setHex(String(s[u[e]].color).replace("0x","#")));return i},o=function(e,t){var n,o,r;return n=a.addFolder(t),o=1e3,r=Math.PI,n.addColor(s[t],"color").name(t).onChange(c),n.add(e.position,"x",-o,o).name("position x"),n.add(e.position,"y",-o,o).name("position y"),n.add(e.position,"z",-o,o).name("position z"),n.add(e.rotation,"x",-r,r).name("rotation x"),n.add(e.rotation,"y",-r,r).name("rotation y"),n.add(e.rotation,"z",-r,r).name("rotation z"),n.open()},o(n,"ambient"),o(r,"directional"),o(i,"directional2"),o(l,"point"),{ambient:n,directional:r,directional2:i,point:l,all:t}}return e}(),angular.module("app").factory("Lights",["GUI",e])}.call(this),function(){var e;window.ObjectDragIOWebgl=e=function(){function e(e,t,n){var o,r,i,a;Happens(this),this.isDown=!1,this.x=0,this.y=0,this.enabled=!1,this.activeElement=!1,this.isRegister=!1,this.tiltController=!1,this.timeout=null,t&&(a=new FULLTILT.getDeviceOrientation({type:"world"}),a.then(function(e){return function(t){e.tiltController=t}}(this))["catch"](function(e){return c.error(e)}),function(e){return function(){}}(this)()),o=function(t){return function(n){return t.isDown=!0,e.addClass("dragging"),n.preventDefault()}}(this),i=function(t){return function(n){return t.isDown=!1,e.removeClass("dragging"),t.emit("release")}}(this),r=function(e){return function(t){var n,o,r,i,a;return clearTimeout(e.timeout),e.enabled?(i=t.pageX,a=t.pageY,o=e.activeElement.offset(),r=e.activeElement.width(),n=e.activeElement.height(),e.x=(i-o.left)/r,e.y=(a-o.top)/n,e.x=THREE.Math.clamp(e.x,0,1),e.y=THREE.Math.clamp(e.y,0,1),e.emit("drag",{x:e.x,y:e.y})):void 0}}(this),e.on("mousedown",o),$("body").on("mouseup",i),t||(e.on("mousemove",r),e.on("mouseleave",function(e){return function(){return e.timeout=setTimeout(i,2e3)}}(this))),this.update=function(e){return function(){var t;return requestAnimationFrame(e.update),e.tiltController?(t=e.tiltController.getScreenAdjustedEuler(),e.x=t.gamma.map(-25,25,0,1),e.emit("drag",{x:e.x,y:.5})):void 0}}(this),this.update()}return e.prototype.enable=function(){return this.enabled=!0},e.prototype.disable=function(){return this.enabled=!1},e.prototype.setActiveElement=function(e,t){this.activeElement=e,this.isRegister=t},e}()}.call(this),function(){var e,t=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1};e=function(){function e(e){var n,o,r,i,a,s,u,l,c,d;return o=[],c=0,d=0,r=[],n=0,i=function(){var i,a,s,u,l,p,f,h;for(p=s=0;25>s;p=++s)for(o[p]=[],f=u=0;4>u;f=++u)for(o[p][f]=[],i=[0,1,2,3,4,5,6,7,8,9,10,11],i=e.shuffle(i),i=env.WEBGL?i.splice(0,2):i.splice(0,6),a=l=0;12>l;a=++l)if(t.call(i,a)>=0?(h="bottle",c++):(h="particle",d++),o[p][f].push(h),r.push(h),n++,env.WEBGL===!1&&n>=200)return},i(),a=function(){return o},s=function(){return r},u=function(){return c},l=function(){return d},{getTotalBottles:u,getTotalParticles:l,getFormatted:a,getOrder:s}}return e}(),angular.module("app").factory("ObjectLayout",["lodash",e])}.call(this),function(){var e;THREE.Box2Helper=function(){function e(e){var t,n;return t=new THREE.Geometry,t.vertices.push(new THREE.Vector3(e.min.x,e.min.y,0)),t.vertices.push(new THREE.Vector3(e.max.x,e.min.y,0)),t.vertices.push(new THREE.Vector3(e.max.x,e.max.y,0)),t.vertices.push(new THREE.Vector3(e.min.x,e.max.y,0)),t.vertices.push(new THREE.Vector3(e.min.x,e.min.y,0)),n={color:65280,wireframe:!0,linewidth:50},new THREE.Line(t,new THREE.LineBasicMaterial(n))}return e}(),e=function(){function e(e,t,n,o,r,i,a,s){var u,l,c,d,p,f,h,m,g,v,y,w,T;return y=100,u=new THREE.Box2(new THREE.Vector2(-y,-y),new THREE.Vector2(y,y)),c=new THREE.Vector3(0,0,-1),l=new THREE.Vector3,f=new THREE.Box2Helper(u),g=o.create(10),m=o.create(10,65280),v=o.create(10,255),r.mobile?g.position.set(0,20,0):(T=function(){var e,t,n,o,r;return t=768,e=1440,n=(a.width-t)/e,n=THREE.Math.clamp(n,0,1),r=s.lerp(-24,-30,n),o=[-26,-4,0],g.position.fromArray(o)},a.on("resize",function(e){return function(){return T()}}(this)),T()),f.visible=!1,g.visible=!1,m.visible=!1,v.visible=!1,f.add(g),f.add(m),f.add(v),e.add(f),d=n.addFolder("ObjectZoomHelper"),d.add(g.position,"x",-y,y).name("position x"),d.add(g.position,"y",-y,y).name("position y"),d.add(g.position,"z",-y,y).name("position z"),h=function(t,n){var o;return e.updateMatrixWorld(),f.updateMatrixWorld(),o=t.position.clone(),o.applyMatrix4(n.matrixWorld)},p=function(){var e,t,n,o;return n=h(g,f),e=h(m,f),o=h(v,f),t=h(m,f),{position:n,lookat:e,transition:o,lookatMarker:t}},w=function(e){var t,n,o;return o=e.position,c.set(0,0,-1),c.applyQuaternion(e.quaternion.clone()),t=140,l.copy(o),l.x+=t*c.x,l.y+=t*c.y,l.z+=t*c.z,f.position.copy(l),f.lookAt(o),n=g.position,m.position.set(n.x,n.y,50),v.position.set(n.x,n.y,-50)},{getScreenPositionData:p,update:w}}return e}(),angular.module("app").factory("ObjectZoomHelper",["Scene","Cameras","GUI","Point","Detect","Responsive","Win","Utils",e])}.call(this),function(){var e;e=function(){function e(e){var t;return t=function(e,t){var n,o;return null==t&&(t=16711680),n=new THREE.SphereGeometry(e,4,4),o=new THREE.Mesh(n,new THREE.MeshBasicMaterial({color:16711680,wireframe:!0}))},{create:t}}return e}(),angular.module("app").factory("Point",["Scene",e])}.call(this),function(){var e;e=function(){function e(){var e;return e=new THREE.Scene}return e}(),angular.module("app").factory("Scene",[e])}.call(this),function(){var e;e=function(){function e(e){return this.postProcessing=!0,this.clickEvent=e.device?"touchstart":"click",this}return e}(),angular.module("app").factory("Settings",["Detect",e])}.call(this),function(){var e;e=function(){function e(){var e,t,n;return this._angle=0,e=function(e){return function(t){e._angle=null!=t?t:0}}(this),t=function(e){return function(t,n){var o,r;return o=new THREE.Vector3(0,1,0),r=.1,t.applyAxisAngle(o,e._angle*n*r),t}}(this),n=function(e){return function(t,n,o,r,i){var a,s,u;return a=new THREE.Vector3(0,1,0),s=5e-4,t.applyAxisAngle(a,e._angle*n*s*i),u=1+n*r*o*i,t.x*=u,t.z*=u,t}}(this),{twist:t,twistAndTaper:n,angle:e}}return e}(),angular.module("app").factory("TwistModifier",[e])}.call(this),function(){var e;Number.prototype.map=function(e,t,n,o){return(this-e)*(o-n)/(t-e)+n},_.mixin({findByValues:function(e,t,n){return _.filter(e,function(e){return _.contains(n,e[t])})}}),e=function(){function e(e,t){var n,o,r,i,a,s,u,l,c,d,p;return l=function(e,t,n){return e+(t-e)*n},i=function(e,t){return setTimeout(t,1e3*e)},r=function(e){return e*(180/Math.PI)},c=function(e){return e*(Math.PI/180)},d=function(e){var t;return t=Math.floor(Math.random()*e.length),{index:t,item:e[t]}},s=function(){return t.path().replace("/"+env.LOCALE,"")},u=function(e){return s().split("/")[e]||!1},a=function(){var e;return e=s().split("/")[2],e?Number(e):!1},n=function(e,t){var n,o,r,i,a,s,u,l,c,d;for(r=[],a=0,u=e.length;u>a;a++)n=e[a],r.push(n.position.distanceTo(t));for(c=1/0,d=-1,i=s=0,l=r.length;l>s;i=++s)o=r[i],c>o&&(d=i,c=o);return d},o=function(e,t){var n,o,r,i,a,s,u,l,c,d;for(o=[],i=0,s=e.length;s>i;i++)d=e[i],o.push(d.distanceTo(t));for(l=1/0,c=-1,r=a=0,u=o.length;u>a;r=++a)n=o[r],l>n&&(c=r,l=n);return c},p=function(t,n){return t.project(n),t.x=Math.round((t.x+1)*e.width/2),t.y=Math.round((-t.y+1)*e.height/2),t.z=0,{x:t.x,y:t.y}},{lerp:l,degrees:r,radians:c,delay:i,toScreenPosition:p,randomArrayItem:d,closestBottleToCamera:n,closestParticleToCamera:o,getDeeplinkUserIndex:a,getUriSegment:u,getPath:s}}return e}(),angular.module("app").factory("Utils",["Win","$location",e])}.call(this),function(){var e;e=function(){function e(e,t){var n,o,r,i;return env.WEBGL===!1?{}:(o=THREE.ImageUtils.loadTexture(Assets.getAsset("BaseTexture").url),n=THREE.ImageUtils.loadTexture(Assets.getAsset("BaseTextureBump").url),i={map:o,specular:1053208,shininess:80,bumpMap:n,specularMap:n,bumpScale:1},r=new THREE.MeshPhongMaterial(i),{material:r})}return e}(),angular.module("app").factory("BaseMaterial",["GUI","Detect",e])}.call(this),function(){var e;e=function(){function e(e){var t,n,o,r,i,a,s;return env.WEBGL===!1?{}:(n=e.addFolder("BottleMaterial"),a=[Assets.getAsset("BottleTexture").url,Assets.getAsset("BottleTexture").url,Assets.getAsset("BottleTexture").url,Assets.getAsset("BottleTexture").url,Assets.getAsset("BottleTexture").url,Assets.getAsset("BottleTexture").url],o=THREE.ImageUtils.loadTextureCube(a),t={color:"#050605",ambient:16777215,emissive:"#000000",specular:16775852},i={color:t.color,ambient:t.ambient,emissive:t.emissive,specular:t.specular,shininess:38,wireframe:!1,opacity:.92,transparent:!0,shading:THREE.SmoothShading,side:THREE.DoubleSide,emissive:661514,envMap:o,combine:THREE.AddOperation,reflectivity:1,refractionRatio:.6},r=new THREE.MeshPhongMaterial(i),s=function(){return r.color.setHex(String(t.color).replace("#","0x")),r.emissive.setHex(String(t.emissive).replace("#","0x")),r.specular.setHex(String(t.specular).replace("#","0x"))},n.addColor(t,"color").onChange(s),n.addColor(t,"emissive").onChange(s),n.addColor(t,"specular").onChange(s),n.add(r,"shininess",0,100),n.add(r,"wireframe"),n.add(r,"opacity",0,1),{material:r})}return e}(),angular.module("app").factory("BottleMaterial",["GUI",e])}.call(this),function(){var e;e=function(){function e(e){var t,n,o,r,i,a,s,u,l,c,d,p,f,h;return env.WEBGL===!1?{}:(a=e.addFolder("BottleMaterial x"),a.open(),t=.4,o={color:"#151615",ambient:16777215,emissive:"#0a180a",specular:16775852},u={color:o.color,ambient:o.ambient,emissive:o.emissive,specular:o.specular,shininess:38,opacity:.92,transparent:!0,shading:THREE.SmoothShading,fog:!1},n=new THREE.MeshPhongMaterial(u),f=function(){},a.add(n,"opacity",0,1),u={alphaMap:THREE.ImageUtils.loadTexture(Assets.getAsset("BottleAlphaMap").url),transparent:!0,opacity:t},l=new THREE.MeshBasicMaterial(u),h=function(e,n){var o;return null==n&&(n=.2),d(),o=document.createElement("img"),o.crossOrigin="",TweenLite.killTweensOf(l),l.opacity=0,o.onload=function(e){return function(){var e;return e=new THREE.Texture(o),e.needsUpdate=!0,l.map=e,l.needsUpdate=!0,u={opacity:t,delay:n},TweenMax.to(l,1,u)}}(this),o.src=e},i=function(e){return function(){return u={opacity:0},TweenMax.allTo([n,l],1,u)}}(this),r=function(e){return function(){return n.opacity=0,l.opacity=0,u={opacity:1},TweenMax.to(n,.6,u)}}(this),s=function(e){return u={opacity:0,onComplete:function(t){return function(){return"function"==typeof e?e():void 0}}(this)},TweenMax.allTo([n,l],1,u)},p=function(){return r()},c=function(){return n.opacity=1},d=function(){return l.opacity=0,l.map=null,l.needsUpdate=!0},{bottleMaterial:n,photoMaterial:l,updatePhotoTexture:h,fadeOut:i,fadeIn:r,hideTransition:s,showTransition:p,resetOpacity:c,resetTexture:d})}return e}(),angular.module("app").factory("BottleZoomMaterial",["GUI",e])}.call(this),function(){var e;e=function(){function e(e){var t,n,o;return env.WEBGL===!1?{}:(t=THREE.ImageUtils.loadTexture(Assets.getAsset("SkyTexture").url),o={map:t,lights:!1,fog:!1},n=new THREE.MeshLambertMaterial(o),{material:n})}return e}(),angular.module("app").factory("DomeMaterial",["GUI",e])}.call(this),function(){var e;e=function(){function e(e){var t,n,o,r;return env.WEBGL===!1?{}:(n=THREE.ImageUtils.loadTexture(Assets.getAsset("FloorTexture").url),t=THREE.ImageUtils.loadTexture(Assets.getAsset("FloorTextureBump").url),r={map:n,bumpMap:t,bumpScale:2,specular:1053208,specularMap:t,shininess:60,side:THREE.DoubleSide},o=new THREE.MeshPhongMaterial(r),e.add(o,"bumpScale",0,100),{material:o})}return e}(),angular.module("app").factory("GroundMaterial",["GUI",e])}.call(this),function(){var e;e=function(){function e(e,t){var n,o,r,i,a,s,u,l;return env.WEBGL===!1?{}:(l=[Assets.getAsset("BottleTexture").url,Assets.getAsset("BottleTexture").url,Assets.getAsset("BottleTexture").url,Assets.getAsset("BottleTexture").url,Assets.getAsset("BottleTexture").url,Assets.getAsset("BottleTexture").url],i=THREE.ImageUtils.loadTextureCube(l),a=THREE.ImageUtils.loadTexture(Assets.getAsset("BaseTexture").url),n={color:"#050605",ambient:16777215,emissive:"#000000",specular:13631404},u={map:a,color:n.color,specular:n.specular,shininess:100,wireframe:!1,opacity:.93,transparent:!0,shading:THREE.SmoothShading,side:THREE.DoubleSide,envMap:i,combine:THREE.AddOperation,reflectivity:1,refractionRatio:.6,bumpMap:a,bumpScale:.5},s=new THREE.MeshPhongMaterial(u),o=function(e){return null==e&&(e=0),s.opacity=0,u={opacity:.93,delay:e},TweenMax.to(s,5,u)},r=function(){return s.opacity=0},{material:s,fadeIn:o,hide:r})}return e}(),angular.module("app").factory("HatMaterial",["GUI","Detect",e])}.call(this),function(){var e;e=function(){function e(e,t,n,o,r,i,a,s){return{BottleMaterial:n,BottleZoomMaterial:o,ParticleMaterial:e,DomeMaterial:a,ParticleZoomMaterial:t,GroundMaterial:r,BaseMaterial:i,HatMaterial:s}}return e}(),angular.module("app").factory("Materials",["ParticleMaterial","ParticleZoomMaterial","BottleMaterial","BottleZoomMaterial","GroundMaterial","BaseMaterial","DomeMaterial","HatMaterial",e])}.call(this),function(){var e;e=function(){function e(e,t){var n,o,r,i;return env.WEBGL===!1?{}:(r={size:20,map:THREE.ImageUtils.loadTexture(Assets.getAsset("Particle").url),transparent:!0,alphaTest:.1,fog:!0},o=new THREE.PointCloudMaterial(r),n=function(e){},i=function(e){},{material:o,hideParticle:n,showParticle:i})}return e}(),angular.module("app").factory("ParticleMaterial",["Fog","Settings",e])}.call(this),function(){var e;e=function(){function e(){var e,t,n,o,r,i,a,s,u,l,c;return env.WEBGL===!1?{}:(e=.4,r={map:THREE.ImageUtils.loadTexture(Assets.getAsset("Particle").url),transparent:!0,fog:!1,side:THREE.DoubleSide},i=new THREE.MeshBasicMaterial(r),r={alphaMap:THREE.ImageUtils.loadTexture(Assets.getAsset("ParticleAlphaMap").url),side:THREE.DoubleSide,transparent:!0,opacity:e},a=new THREE.MeshBasicMaterial(r),c=function(t,n){var o;return null==n&&(n=.2),o=document.createElement("img"),o.crossOrigin="",TweenLite.killTweensOf(a),a.opacity=0,o.onload=function(t){return function(){var t;return t=new THREE.Texture(o),t.needsUpdate=!0,a.map=t,a.needsUpdate=!0,r={opacity:e,delay:n},TweenMax.to(a,1,r)}}(this),o.src=t},n=function(e){return function(){return r={opacity:0},TweenMax.allTo([i,a],.6,r)}}(this),t=function(t){return function(){return i.opacity=0,a.opacity=e,r={opacity:1},TweenMax.to(i,.6,r)}}(this),o=function(e){return r={opacity:0,onComplete:function(t){return function(){return"function"==typeof e?e():void 0}}(this)},TweenMax.allTo([i,a],1,r)},l=function(){return t()},s=function(){return i.opacity=1,a.opacity=e},u=function(){return a.map=null,a.needsUpdate=!0},{particleMaterial:i,photoMaterial:a,updatePhotoTexture:c,fadeOut:n,hideTransition:o,showTransition:l,resetOpacity:s,resetTexture:u})}return e}(),angular.module("app").factory("ParticleZoomMaterial",[e])}.call(this),function(){var e;e=function(){function e(e,t,n){var o,r,i,a,s,u,l;return o={percent:0},a=null,i=e.addFolder("intro path"),r=null,s=function(e){return r=new THREE.CameraDolly(t.user,n,e,i),i.add(o,"percent",0,1).onChange(function(){return r.cameraPosition=o.percent,r.lookatPosition=o.percent,r.update()}),i.add(r,"exportPositions")},l=function(e){return null!=r?r.updateCameraPoints(e):void 0},u=function(e){return r.cameraPosition=e,r.lookatPosition=e,r.update()},{setup:s,path:a,updatePoints:l,updateCameraPosition:u}}return e}(),angular.module("app").factory("IntroPath",["GUI","Cameras","Scene",e])}.call(this),function(){var e;e=function(){function e(e,t,n){var o,r,i,a,s,u,l,c;return o={percent:.1},s=null,i=e.addFolder("tower path"),i.open(),r=null,u=function(e,a){return e.camera=a,r=new THREE.CameraDolly(t.user,n,e,i,!0),i.add(o,"percent",0,1).onChange(function(){return r.cameraPosition=o.percent,r.lookatPosition=o.percent,r.update()}),i.add(r,"exportPositions")},c=function(e){return null!=r?r.updateCameraPoints(e):void 0},l=function(e){return e=THREE.Math.clamp(e,0,1),r.cameraPosition=e,r.lookatPosition=e,r.update()},a=function(e){return r.getPointOnCameraPath(e)},{setup:u,updatePoints:c,updateCameraPosition:l,getPointOnCameraPath:a}}return e}(),angular.module("app").factory("TowerPath",["GUI","Cameras","Scene",e])}.call(this);